@use '../mixin/_cq.scss' as cq;
@use '../mixin/_text.scss' as text;
@use '../mixin/_timeline.scss' as timeline;
@use '../mixin/_visibility.scss' as visibility;



[data-raisonne-elem="wrapper"] {
    overflow: clip;
    width: 100%;
    max-width: 100%;
    // height: auto;
    // display: flow-root;

}

[data-raisonne-mode="timeline"] {
    position: relative;
    // position: sticky;
    // width: 100%;
    overflow-x: clip;
    width: 100vw;
    max-width: 100vw;
            // top: 0;
            // left: 0;
            // height: 50vh;
            // overflow-y: auto;
    // overflow: scroll;
    // height: 50%;

    &[data-raisonne-type="event"] {

        & [data-raisonne-elem="header"] {
            border-top: 0.25rem var(--libRaisonneBorderStyleBase) var(--libRaisonneColorMainPrimary);
            position: sticky;
            top: 0;
            left: 0;
            width: 100vw;
            max-width: 100vw;
            height: var(--libRaisonneHeaderHeight);
            background: #fff;
            z-index: var(--libRaisonneZindexUiGlobal);

            & [data-raisonne-elem="header-contents"] {
                // position: sticky;
                // height: auto;
                overflow-x: hidden;
                display: flex;
            }


            & [data-raisonne-header-nav-elem="contents"] {
                overflow: scroll;
            }

            & [data-raisonne-header-nav-elem="controller"] {
                position: absolute;
                // width: var(--libRaisonneSizeRemEventDetailWidth);
                // @include cq.phone(max) {
                //     width: calc(var(--libRaisonneGridUnitBase) * 4);
                // }
                @include timeline.sizeDiffStickyLeft(width);
                // height: var(--libRaisonneSizeRemEventDetailHeight);
                height: 5.3rem;
                z-index: 2;
                background: var(--libRaisonneColorBgBase);
                border-right:  var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateBase);
                border-bottom:  var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateBase);
            }

            & [data-raisonne-elem="controller-contents"] {
                // background: #f0f;
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0;
                left: 0;
                border-bottom:  var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateBase);
            }

            & [data-raisonne-elem="controller-contents-label-event"] {
                margin: 0;
                font-weight: 400;
                padding: 0.25em 1em 0.25em 0.25em;
            }

            & [data-raisonne-elem="controller-contents-label-event-title"] {
                font-size: 0.6875rem;
                // display: block;
            }

            & [data-raisonne-elem="controller-contents-label-event-num"] {
                
            }

            & [data-raisonne-header-nav-elem="years"] {
                position: absolute;
                left: var(--libRaisonnePosTimelineScrollX);//これを動かしてスクロール連動させる。
                // iOSではstickyを諦めてtransformにする？
                // transform: translateX(var(--libRaisonnePosTimelineScrollX));
                // padding-left: var(--libRaisonneSizeRemEventDetailWidth);
                @include timeline.sizeDiffStickyLeft(padding);
            }

            & [data-raisonne-header-nav-elem="year"] {
                display: flex;
            }

            & [data-raisonne-header-nav-elem="month"] {
                // display: flex;
                position: relative;
                border-left:  var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateBase);

                &:first-child {
                    border-left: none;
                }
            }

            & [data-raisonne-header-nav-elem="month-label"] {
                position: sticky;
                bottom: 0;
                left: 0;
                display: inline-block;
                font-size: 1.5rem;
                margin: 0;
                padding: 0.25em 1em 0.25em 0.25em;
                // transform:  translateX(var(--libRaisonneSizeRemEventDetailWidth));
                // margin-left: calc(-1 * var(--libRaisonneSizeRemEventDetailWidth));
                // width: calc(100% - (var(--libRaisonneSizeRemEventDetailWidth) * 1.5));
                @include timeline.sizeDiffStickyLeft(years);
                font-weight: 400;

                & [data-raisonne-header-nav-elem="month-label-year"] {
                    display: inline-block;
                    font-size: 0.875rem;
                    transform: translateY(-0.5rem);
                }

                & [data-raisonne-header-nav-elem="month-label-separator"] {
                    color: var(--libRaisonneBorderColorSeparateBase);
                }

                & [data-raisonne-header-nav-elem="month-label-month"] {

                }
            }

            & [data-raisonne-header-nav-elem="days"] {
                display: flex;
                border-bottom:  var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateBase);
            }

            & [data-raisonne-header-nav-elem="day"] {
            }

            & [data-raisonne-header-nav-elem="day-num"], & [ data-raisonne-header-nav-elem="day-week"] {
                width: var(--libRaisonneGridUnitBase);
                height: var(--libRaisonneGridUnitBase);
                display: flex;
                align-items: center;
                justify-content: center;
                border-right: var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateDays);
            }

            & [data-raisonne-header-nav-elem="day-num"]{
                border-top:  var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneHeaderColorBgDayWeek);
                border-right: var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateDays);
                background: var(--libRaisonneColorBgBase);
                font-size: 0.875em;
            }

            & [ data-raisonne-header-nav-elem="day-week"]{
                background: var(--libRaisonneHeaderColorBgDayWeek);
                height: calc(var(--libRaisonneGridUnitBase) * 0.75);
                font-size: 0.6875em;
            }

            & [data-raisonne-header-date-dw="6"] {
                color: var(--libRaisonneColorTextDayWeekSat);
            }

            & [data-raisonne-header-date-dw="0"] {
                color: var(--libRaisonneColorTextDayWeekSun);
            }
        }
        & [data-raisonne-elem="contents"] {
            position: relative;
            cursor: grab;
            user-select: none;
            height: calc(100vh - var(--libRaisonneHeaderHeight));
            height: auto;
            overflow-x: auto;

            &:hover {
                background-color: #f9f9f9;

            }


            
            &:has( [data-raisonne-elem="timeline-event-detail-header"]:hover ):hover,
            &:has( [data-raisonne-elem="timeline-event-detail-body"]:hover ):hover {
                background-color: var(--libRaisonneColorBgBase);
            }

            &:active {
                cursor: grabbing;
                background-color: #fff;
            }

            & [data-raisonne-elem="body"] {
            }

            & [data-raisonne-elem="details"] {
                min-height: 24rem;
                pointer-events: none;
                list-style-type: none;
                position: relative;
                margin: 0;
                padding: var(--libRaisonneGridUnitBase) 0 4rem 0;
                width: fit-content;
                background: 
                linear-gradient(90deg, var(--libRaisonneColorColumnOdd) var(--libRaisonneGridUnitBase), var(--libRaisonneColorColumnEven) var(--libRaisonneGridUnitBase)) 0 0 / calc(var(--libRaisonneGridUnitBase) * 2) calc(var(--libRaisonneGridUnitBase) * 2);
                    
                &::before {
                    display: block;
                    @include timeline.sizeDiffStickyLeft(width);
                    height: calc(100% - (var(--libRaisonneGridUnitBase) * 2));
                    content: " ";
                    background: #fff;
                    position: fixed;
                    top: 0;
                    left: 0;
                    border-right: var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorEventDetail);
                }

                [data-raisonne-elem="timeline-event-detail"] {
                    // width: 100%;
                    // margin-bottom: 1rem;
                    position: relative;
                    // padding-bottom: 1.5rem;
                    display: flex;
                    border-top: var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorEventDetail);
                    pointer-events: none;

                    @include visibility.display();

                    &:hover {
                        background-color: var(--libRaisonneColorBgEventDetail);
                    }
                }

                [data-raisonne-elem="timeline-event-detail-body"] {
                    pointer-events: auto;
                    cursor: default;
                    position: relative;
                    // background: var(--libRaisonneColorBgBase);
                }

                [data-raisonne-elem="timeline-event-detail-duration"] {
                    // border-top: var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorSeparateBase);
                    z-index: 1;
                    &::before {
                        display: block;
                        content: " ";
                        position: absolute;
                        top: 0;
                        left: 0;
                        z-index: 1;
                        width: 100%;
                        height: var(--libRaisonneBorderWeightBase);
                        background: var(--libRaisonneBorderColorSeparateBase);
                    }
                }

                [data-raisonne-elem="timeline-event-detail-duration-body"] {
                    display: block;
                }

                [data-raisonne-elem="timeline-event-detail-header"] {
                    pointer-events: auto;
                    cursor: default;
                    // width: var(--libRaisonneSizeRemEventDetailWidth);
                    @include timeline.sizeDiffStickyLeft(width);
                    height: var(--libRaisonneSizeRemEventDetailHeight);
                    background: var(--libRaisonneColorBgBase);
                    border-right: var(--libRaisonneBorderWeightBase) var(--libRaisonneBorderStyleBase) var(--libRaisonneBorderColorEventDetail);
                    position: sticky;
                    top: 0;
                    left: 0;
                    z-index: 2;
                }
                
                [data-raisonne-elem="timeline-event-detail-title-wrapper"] {
                    font-size: var(--libRaisonneFontSizeTitleAll);
                    // width: var(--libRaisonneSizeRemEventDetailWidth);
                    @include timeline.sizeDiffStickyLeft(width);
                    @include text.weight(regular);
                    margin: 0;
                }
                
                [data-raisonne-elem="timeline-event-detail-title-crown"] {
                    display: block;
                    margin-bottom: 0.125rem;
                    font-size: var(--libRaisonneFontSizeTitleCrown);
                }
                
                [data-raisonne-elem="timeline-event-detail-title-main"] {
                
                }
                
                [data-raisonne-elem="timeline-event-detail-title-sub"] {
                    // display: block;
                    display: inline-block;
                    font-size: var(--libRaisonneFontSizeTitleSub);
                    margin-left: 0.5em;
                }

                [data-raisonne-elem="timeline-event-detail-date-term"] {
                    display: block;
                    margin-top: 0.25rem;
                    font-size: 0.875rem;
                    position: sticky;
                    top: 0;
                    left: 0;
                    @include timeline.sizeDiffStickyLeft(dateTerm);
                    width: 100%;
                    min-width: fit-content;
                    max-width: fit-content;
                    pointer-events: none;
                }

                [data-raisonne-elem="timeline-event-detail-date-term-str-another"] {
                    // font-size: 0.875rem;
                    @include text.head();
                }

                [data-raisonne-elem="timeline-event-detail-date-term-day"] {
                    &.dateStart, &.dateEnd {

                    }
                    &.dateEnd {
                        font-size: 0.75rem;
                    }
                }
            }
        }
    }
}